function debounce(func,threshold,execAsap){var timeout;return function debounced(){var obj=this,args=arguments;function delayed(){if(!execAsap)
func.apply(obj,args);timeout=null};if(timeout)
clearTimeout(timeout);else if(execAsap)
func.apply(obj,args);timeout=setTimeout(delayed,threshold||100)}};loc='/';if(window.location.origin=="https://blog.dreamstime.com")
loc='https://www.dreamstime.com/';$(function(){auxsubmit=$('form[name=contfrm] button').text();$('input[name="M_email"]').focus(function(){$(this).removeAttr('readonly')});$('input[name="M_email"]').blur(function(){if($(this).val()!='')sgn_check_email();});$('input[name="M_password"]').focus(function(){$(this).removeAttr('readonly')});$('input[name="M_password"]').keyup(function(){if($(this).val().length>3&&$('input[name="M_email"].border-error').length==0)debounce_sgn_run_pass();});$('#referral-open').click(function(){$(this).parent().toggle();$('#referral-input').toggle()});$('#referral-input').blur(function(){if($(this).val()!='')sgn_check_ref(1);});$('#promo-open').click(function(){$(this).parent().toggle();$('#promo-input').toggle()});$('#promo-input').blur(function(){if($(this).val()!='')sgn_check_ref(2);});if($('form[name=contfrm] button').length>0)
$('form[name=contfrm] button').click(function(){DT.Scheduler.postTask(()=>{ga('set','nonInteraction',!0);ga('send','event',{eventCategory:'RegisterPopup',eventAction:'Sign Up',eventLabel:'ClickSignUp',eventValue:1})},{priority:'user-visible'});sgn_create_user()});if($('.js-submit-button').length>0)
$('.js-submit-button').click(function(){DT.Scheduler.postTask(()=>{ga('set','nonInteraction',!0);ga('send','event',{eventCategory:'RegisterPopup',eventAction:'Sign Up',eventLabel:'ClickSignUp',eventValue:1})},{priority:'user-visible'});sgn_create_user()});$('#popup-signup .close').click(function(){DT.Scheduler.postTask(()=>{ga('set','nonInteraction',!0);ga('send','event',{eventCategory:'RegisterPopup',eventAction:'Close',eventLabel:'ClickClose',eventValue:1,})},{priority:'user-visible'});SignUPPopup_close()});$('input[name=M_email],input[name="M_password"],input[name="M_promocodeandref"],input[name="M_resellerid"]').tooltipster({theme:['dt-pink'],side:'right',distance:0,contentCloning:!1,contentAsHTML:!0,trigger:'custom'});$('input[name=M_email],input[name="M_password"],input[name="M_promocodeandref"],input[name="M_resellerid"]').keypress(function(e){if(e.which==13)sgn_create_user();if(signin==1&&$(this).val().length>=3)signin=0;DT.Scheduler.postTask(()=>{$(this).tooltipster('close')},{priority:'user-visible'})});if(window.location.pathname.indexOf('/upload')!=-1||window.location.pathname=='/schooliscool')
$('input[name=jump_to]').val(window.location.href);});var usernametested='';var emailtested='';var promotested='';var signin=1;function lastkeyloginpop(){if($('input[name=M_email]').val().length>=3&&$('input[name=M_password]').val().length>=6){$.ajax({type:'POST',url:'/ajax/signupin.php',data:'securitycheck='+securitycheck+'&do_action=log_into_system'+'&uname='+$('input[name=M_email]').val()+'&pass='+$('input[name=M_password]').val(),success:function(msg){if(msg==1)location.reload();},error:function(msg){}})}}
$('input[name=M_password]').on('keypress',debounce(function(){lastkeyloginpop()},500));async function sgn_check_email(){element='input[name=M_email]';if($(element).val().indexOf(' ')>-1){DT.Scheduler.postTask(()=>{$(element).addClass('border-error').select().tooltipster('content','Please do not use spaces in your email address!').tooltipster('open')},{priority:'user-visible'});return}
if(!/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,})+$/.test($(element).val())){DT.Scheduler.postTask(()=>{$(element).addClass('border-error').select().tooltipster('content','Invalid email format!').tooltipster('open')},{priority:'user-visible'});return}else{await(new Promise((resolve)=>{$.ajax({type:'POST',url:loc+'ajax/checkusername_ab185.php?email='+$(element).val(),success:function(text){emailtested=text;resolve()},})}));if(emailtested.indexOf('is valid')!=-1){DT.Scheduler.postTask(()=>{$(element).removeClass('border-error').tooltipster('close')},{priority:'user-visible'});if($('input[name=M_login]').val()=='')sgn_predict_uname();}else{DT.Scheduler.postTask(()=>{$(element).addClass('border-error').tooltipster('content',emailtested).tooltipster('open')},{priority:'user-visible'})}}}
function getRandomInt(min,max){return Math.floor(Math.random()*(max-min+1))+min}
function sgn_predict_uname(){element='input[name=M_login]';elementem='input[name=M_email]';unam=$(elementem).val().substr(0,$(elementem).val().indexOf('@')).replace(/[`~!@#$%^&*()_|+\-=?;:'",.<>\{\}\[\]\\\/]/gi,'');switch(unam.length){case 1:unam=unam+getRandomInt(10000,99999);break;case 2:unam=unam+getRandomInt(1000,9999);break;case 3:unam=unam+getRandomInt(100,999);break;case 4:unam=unam+getRandomInt(10,99);break;case 5:unam=unam+getRandomInt(1,9);break}
unam=unam.charAt(0).toUpperCase()+unam.slice(1);$.ajax({type:'POST',url:loc+'ajax/checkusername_ab185.php?user='+unam,success:function(text){usernametested=text;$(element).val(usernametested)},})}
function check_substr(yourstring,cond){if(cond==1){var substrings=['qwerty123','qwerty1234','123qwerty','1234qwerty'],len=substrings.length;while(len--){if(yourstring.toLowerCase().indexOf(substrings[len])!=-1)
return!0}}
if(cond==2){if(yourstring.match("([A-Za-z]+[0-9](.*)|[0-9]+[A-Za-z](.*))[A-Za-z0-9]*(.*)")!==null)
return!0;else return!1}}
function sgn_run_pass(){element='input[name=M_password]';strPassword=$(element).val();if(strPassword.indexOf(' ')>-1){DT.Scheduler.postTask(()=>{$(element).addClass('border-error').val('').tooltipster('content','Please do not use spaces in your password!').tooltipster('open')},{priority:'user-visible'})}
if(check_substr(strPassword,1)){DT.Scheduler.postTask(()=>{$(element).addClass('border-error').tooltipster('content','Password strength: Too weak').tooltipster('open')},{priority:'user-visible'});return}
if(!check_substr(strPassword,2)){DT.Scheduler.postTask(()=>{$(element).addClass('border-error').tooltipster('content','Password strength: Too weak<br>Use both letters and numbers').tooltipster('open')},{priority:'user-visible'});return}
if($('input[name=M_email]').val().length>5&&($('input[name=M_password]').val().toLowerCase().indexOf($('input[name=M_email]').val().toLowerCase())!=-1)){DT.Scheduler.postTask(()=>{$(element).addClass('border-error').tooltipster('content','Your password must NOT contain or be the same as your email.').tooltipster('open')},{priority:'user-visible'})}
if($('input[name=M_password]').val().toLowerCase()==$('input[name=M_login]').val().toLowerCase()){DT.Scheduler.postTask(()=>{$(element).addClass('border-error').select().tooltipster('content','Your password must NOT be the same as your username.').tooltipster('open')},{priority:'user-visible'})}
var nScore=checkPassword(strPassword);if(strPassword.length<6){var strText="Too short"}else if(nScore>=60){var strText="Very Strong"}else if(nScore>=50){var strText="Strong"}else if(nScore>=25){var strText="Good"}else{var strText="Weak"}
if(strText.indexOf('Good')>-1||strText.indexOf('Strong')>-1||strText.indexOf('Very Strong')>-1){DT.Scheduler.postTask(()=>{$(element).removeClass('border-error').tooltipster('close');$(element).tooltipster('content','<strong>Congratulations! Your password is '+strText.toLowerCase()+'!</strong>').tooltipster('open');setTimeout(function(){DT.Scheduler.postTask(()=>{$(element).removeClass('border-error').tooltipster('close')},{priority:'user-visible'})},2000)},{priority:'user-visible'})}else{strText2=strText;if(strText.indexOf('Too short')>-1)
strText2="Password strength: Too short<br>You need at least 6 characters.";if(strText.indexOf('Weak')>-1)
strText2="Password strength: Too weak<br>Choose a password that's unique to you and difficult for others to guess.";DT.Scheduler.postTask(()=>{$(element).addClass('border-error').tooltipster('content','<strong>'+strText2+'</strong>').tooltipster('open')},{priority:'user-visible'})}}
var debounce_sgn_run_pass=debounce(sgn_run_pass,200);async function sgn_check_ref(mode){if(mode==2)element='input[name=M_promocodeandref]';else if(mode==1)element='input[name=M_resellerid]';if($(element).val().indexOf(' ')>-1){DT.Scheduler.postTask(()=>{$(element).addClass('border-error').select().tooltipster('content','Please do not use spaces in your code!').tooltipster('open')},{priority:'user-visible'})}
if($(element).val().length>0){await(new Promise((resolve)=>{$.ajax({type:'POST',url:loc+'ajax/checkusername_ab185.php?promo='+$(element).val()+'&mode='+mode,success:function(text){promotested=text;resolve()},})}))}
if(promotested.length>0){if(promotested.indexOf('Please provide referral')!=-1||promotested.indexOf('There is no such user')!=-1)
good=0;else if(promotested.indexOf('Code is correct.')!=-1)good=2;else good=1}else good=1;if(good==0){DT.Scheduler.postTask(()=>{$(element).addClass('border-error').select().tooltipster('content','<strong>'+promotested+'</strong>').tooltipster('open')},{priority:'user-visible'})}else{$(element).removeClass('border-error').tooltipster('close');if(good==2){DT.Scheduler.postTask(()=>{$(element).tooltipster('content','<strong>Code is correct.</strong>').tooltipster('open')},{priority:'user-visible'})}else{DT.Scheduler.postTask(()=>{$(element).tooltipster('content','<strong>'+promotested+'</strong>').tooltipster('open')},{priority:'user-visible'})}
setTimeout(function(){DT.Scheduler.postTask(()=>{$(element).removeClass('border-error').tooltipster('close')},{priority:'user-visible'})},4000)}}
function popcreateuser(action){if(action==1){$.post(loc+'ajax/8signup_save.php',$('form[name=contfrm]').serialize(),function(data){if(data.indexOf(':Success GG')>0){var t=setTimeout(function(){if(data.indexOf('|js|')==-1){userid=data.replace(':Success GG','');popupsignupvalidate=1;popupsignupvalidatev=0}else{aux=data.split('|js|');userid=aux[0].replace(':Success GG','');popupsignupvalidate=parseInt(aux[1]);popupsignupvalidatev=parseInt(aux[2])}
usernn=$('input[name=M_login]').val();start=1;countdown=setInterval(function(){start--;if(start==0){clearInterval(countdown);if(!popupsignupvalidate&&(popupsignupvalidatev==1||popupsignupvalidatev==2)){if(popupsignupvalidatev==1)
Validate_load();if(popupsignupvalidatev==2&&getCookie('validate_email')==null){Validate_load();setCookie2('validate_email',1);setTimeout(function(){$('.popup-wrapper.popup-signup').prepend('<a class="close" href="javascript:void(0)" onclick="popup_close(); location.reload();"><i class="icon icon-close"></i></a>')},1000)}}else if($('input[name=jump_to_ab]').val()!=''&&$('input[name=jump_to_ab]').val()!=undefined){location=$('input[name=jump_to_ab]').val()+'?toft=1'}else{if($('input[name=jump_to]').val()==''||$('input[name=jump_to]').val()==undefined)
location="/credits";else location=$('input[name=jump_to]').val()}}},1000)},1000)}else{$('.notifications').html(data).show();setTimeout(function(){$('.notifications').html('').hide()},5000);$('form[name=contfrm] input.border-error:first').focus()}})}}
function sgn_create_user(){if($('input[name=M_password]').val()!=''&&$('input[name=M_email]').val()!=''&&signin==1){$.post(loc+'ajax/signupin.php',$('form[name=contfrm]').serialize().replace('do_action=add','do_action=log_into_system'),function(data){if(data==''){}else{if($('input[name=jump_to]').length)
location=$('input[name=jump_to]').val();else location=location.origin}})}
if($('form[name=contfrm] input.border-error').length>0&&$('input[name=M_email]').val()!=''&&$('input[name=M_login]').val()!=''&&$('input[name=M_password]').val()!=''){$('.notifications').html('Please fix all errors before creating an account.').show();setTimeout(function(){$('.notifications').html('').hide()},3000);$('form[name=contfrm] input.border-error:first').focus()}else if($('input[name=M_email]').val()==''||$('input[name=M_password]').val()==''){$('.notifications').html('Required fields are empty or username is less than 6 characters.').show();setTimeout(function(){$('.notifications').html('').hide()},3000);$('form[name=contfrm] input.border-error:first').focus()}else{var isInvisibleRecaptcha=$('#grechpi').data('size')=='invisible';if(isInvisibleRecaptcha){grecaptcha.execute()}else{popcreateuser(1)}}}
function recaptchaValidResponse(response){if(response&&response.length>32){$('#invisible-captcha-respinse').val(response);popcreateuser(1)}else{$('#popup-signup form > button').tooltipster({theme:['dt-pink'],side:'right',distance:0,contentCloning:!1,contentAsHTML:!0,trigger:'custom'});DT.Scheduler.postTask(()=>{$('#popup-signup form > button').tooltipster('content','<strong>Invalid captcha. Please try again!</strong>').tooltipster('open')},{priority:'user-visible'});setTimeout(function(){document.location.reload()},5000)}}